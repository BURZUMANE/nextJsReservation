{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/timurzakirov/Documents/self/nextJsReservation/pages/adress.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { Typography, Box, CardContent, Card, Button, TextField } from '@material-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Field, Form, Formik, FormikConfig, FormikValues } from 'formik';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport { reservationSlice } from '../lib/slices/reservationSlice';\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport parse from 'autosuggest-highlight/parse';\nimport throttle from 'lodash/throttle';\nimport { useRouter } from 'next/router';\nimport * as yup from 'yup';\nimport PlacesAutocomplete, { geocodeByAddress, getLatLng } from 'react-places-autocomplete';\n\nfunction loadScript(src, position, id) {\n  if (!position) {\n    return;\n  }\n\n  var script = document.createElement('script');\n  script.setAttribute('async', '');\n  script.setAttribute('id', id);\n  script.src = src;\n  position.appendChild(script);\n}\n\nvar autocompleteService = {\n  current: null\n};\nvar useStyles = makeStyles(function (theme) {\n  return {\n    icon: {\n      color: theme.palette.text.secondary,\n      marginRight: theme.spacing(2)\n    }\n  };\n});\nvar validationSchema = yup.object().shape({\n  adress: yup.string().required()\n});\nexport default function Adress() {\n  _s();\n\n  var _this = this;\n\n  var dispatch = useDispatch();\n  var router = useRouter();\n  var classes = useStyles();\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      value = _React$useState2[0],\n      setValue = _React$useState2[1];\n\n  var _React$useState3 = React.useState(''),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      inputValue = _React$useState4[0],\n      setInputValue = _React$useState4[1];\n\n  var _React$useState5 = React.useState([]),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      options = _React$useState6[0],\n      setOptions = _React$useState6[1];\n\n  var loaded = React.useRef(false); // if (typeof window !== 'undefined' && !loaded.current) {\n  //   if (!document.querySelector('#google-maps')) {\n  //     loadScript(\n  //       'https://maps.googleapis.com/maps/api/js?key=AIzaSyATyME8aPrEABRhIh8mtOXnfNdQ8ofNEq0&libraries=places',\n  //       document.querySelector('head'),\n  //       'google-maps'\n  //     );\n  //   }\n  //   loaded.current = true;\n  // }\n\n  function removeGoogleMapScript() {\n    console.debug('removing google script...');\n    var keywords = ['maps.googleapis']; //Remove google from BOM (window object)\n\n    window.google = undefined; //Remove google map scripts from DOM\n\n    var scripts = document.head.getElementsByTagName('script');\n\n    var _loop = function _loop(i) {\n      var scriptSource = scripts[i].getAttribute('src');\n\n      if (scriptSource != null) {\n        if (keywords.filter(function (item) {\n          return scriptSource.includes(item);\n        }).length) {\n          scripts[i].remove(); // scripts[i].parentNode.removeChild(scripts[i]);\n        }\n      }\n    };\n\n    for (var i = scripts.length - 1; i >= 0; i--) {\n      _loop(i);\n    }\n  }\n\n  var fetch = React.useMemo(function () {\n    return throttle(function (request, callback) {\n      autocompleteService.current.getPlacePredictions(request, callback);\n    }, 200);\n  }, []);\n  React.useEffect(function () {\n    var active = true;\n\n    if (!autocompleteService.current && window.google) {\n      autocompleteService.current = new window.google.maps.places.AutocompleteService();\n    }\n\n    if (!autocompleteService.current) {\n      return undefined;\n    }\n\n    if (inputValue === '') {\n      setOptions(value ? [value] : []);\n      return undefined;\n    }\n\n    fetch({\n      input: inputValue\n    }, function (results) {\n      if (active) {\n        var newOptions = [];\n\n        if (value) {\n          newOptions = [value];\n        }\n\n        if (results) {\n          newOptions = [].concat(_toConsumableArray(newOptions), _toConsumableArray(results));\n        }\n\n        setOptions(newOptions);\n      }\n    });\n    return function () {\n      active = false;\n    };\n  }, [value, inputValue, fetch]);\n  var state = useSelector(function (state) {\n    return state.reservation.location.adress;\n  });\n  return __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 5\n    }\n  }, __jsx(CardContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }\n  }, __jsx(Formik, {\n    initialValues: {\n      adress: ''\n    },\n    validationSchema: validationSchema,\n    onSubmit: /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value) {\n        var coords, latLng, location;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                coords = /*#__PURE__*/function () {\n                  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value) {\n                    var results, latLng;\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            _context.next = 2;\n                            return geocodeByAddress(value);\n\n                          case 2:\n                            results = _context.sent;\n                            _context.next = 5;\n                            return getLatLng(results[0]);\n\n                          case 5:\n                            latLng = _context.sent;\n                            return _context.abrupt(\"return\", latLng);\n\n                          case 7:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n\n                  return function coords(_x2) {\n                    return _ref2.apply(this, arguments);\n                  };\n                }();\n\n                _context2.next = 3;\n                return coords(value.adress.description);\n\n              case 3:\n                latLng = _context2.sent;\n                location = {\n                  adress: value.adress.description,\n                  latLng: latLng\n                };\n                dispatch(reservationSlice.actions.setAdress(location));\n                removeGoogleMapScript();\n                router.push('/summary');\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, function (_ref3) {\n    var isSubmitting = _ref3.isSubmitting,\n        values = _ref3.values,\n        setFieldValue = _ref3.setFieldValue,\n        errors = _ref3.errors;\n    return __jsx(Form, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 13\n      }\n    }, __jsx(Autocomplete, {\n      id: \"google-map-demo\",\n      style: {\n        width: 300\n      },\n      getOptionLabel: function getOptionLabel(option) {\n        return typeof option === 'string' ? option : option.description;\n      },\n      filterOptions: function filterOptions(x) {\n        return x;\n      },\n      options: options,\n      autoComplete: true,\n      includeInputInList: true,\n      filterSelectedOptions: true,\n      value: state,\n      onChange: function onChange(event, newValue) {\n        dispatch(reservationSlice.actions.setAdresDesc(newValue.description));\n        return setFieldValue('adress', newValue);\n      },\n      onInputChange: function onInputChange(event, newInputValue) {\n        setInputValue(newInputValue);\n      },\n      renderInput: function renderInput(params) {\n        return __jsx(TextField, _extends({}, params, {\n          label: \"Add a location\",\n          variant: \"outlined\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 19\n          }\n        }));\n      },\n      renderOption: function renderOption(option) {\n        var matches = option.structured_formatting.main_text_matched_substrings;\n        var parts = parse(option.structured_formatting.main_text, matches.map(function (match) {\n          return [match.offset, match.offset + match.length];\n        }));\n        return __jsx(Grid, {\n          container: true,\n          alignItems: \"center\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 21\n          }\n        }, __jsx(Grid, {\n          item: true,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 23\n          }\n        }, __jsx(LocationOnIcon, {\n          className: classes.icon,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 25\n          }\n        })), __jsx(Grid, {\n          item: true,\n          xs: true,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 23\n          }\n        }, parts.map(function (part, index) {\n          return __jsx(\"span\", {\n            key: index,\n            style: {\n              fontWeight: part.highlight ? 700 : 400\n            },\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 27\n            }\n          }, part.text);\n        }), __jsx(Typography, {\n          variant: \"body2\",\n          color: \"textSecondary\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 25\n          }\n        }, option.structured_formatting.secondary_text)));\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 15\n      }\n    }), __jsx(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      type: \"submit\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 15\n      }\n    }, \"Submit\"));\n  })));\n}\n\n_s(Adress, \"ITTYpWaIdGI5REaACc0LfYHVPHY=\", false, function () {\n  return [useDispatch, useRouter, useStyles, useSelector];\n});\n\n_c = Adress;\n\nvar _c;\n\n$RefreshReg$(_c, \"Adress\");","map":{"version":3,"sources":["/Users/timurzakirov/Documents/self/nextJsReservation/pages/adress.js"],"names":["Typography","Box","CardContent","Card","Button","TextField","useDispatch","useSelector","Field","Form","Formik","FormikConfig","FormikValues","Autocomplete","reservationSlice","LocationOnIcon","Grid","makeStyles","parse","throttle","useRouter","yup","PlacesAutocomplete","geocodeByAddress","getLatLng","loadScript","src","position","id","script","document","createElement","setAttribute","appendChild","autocompleteService","current","useStyles","theme","icon","color","palette","text","secondary","marginRight","spacing","validationSchema","object","shape","adress","string","required","Adress","dispatch","router","classes","React","useState","value","setValue","inputValue","setInputValue","options","setOptions","loaded","useRef","removeGoogleMapScript","console","debug","keywords","window","google","undefined","scripts","head","getElementsByTagName","i","scriptSource","getAttribute","filter","item","includes","length","remove","fetch","useMemo","request","callback","getPlacePredictions","useEffect","active","maps","places","AutocompleteService","input","results","newOptions","state","reservation","location","coords","latLng","description","actions","setAdress","push","isSubmitting","values","setFieldValue","errors","width","option","x","event","newValue","setAdresDesc","newInputValue","params","matches","structured_formatting","main_text_matched_substrings","parts","main_text","map","match","offset","part","index","fontWeight","highlight","secondary_text"],"mappings":"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","sourcesContent":["import {\n  Typography,\n  Box,\n  CardContent,\n  Card,\n  Button,\n  TextField,\n} from '@material-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Field, Form, Formik, FormikConfig, FormikValues } from 'formik';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport { reservationSlice } from '../lib/slices/reservationSlice';\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport parse from 'autosuggest-highlight/parse';\nimport throttle from 'lodash/throttle';\nimport { useRouter } from 'next/router';\nimport * as yup from 'yup';\nimport PlacesAutocomplete, {\n  geocodeByAddress,\n  getLatLng,\n} from 'react-places-autocomplete';\n\nfunction loadScript(src, position, id) {\n  if (!position) {\n    return;\n  }\n\n  const script = document.createElement('script');\n  script.setAttribute('async', '');\n  script.setAttribute('id', id);\n  script.src = src;\n  position.appendChild(script);\n}\n\nconst autocompleteService = { current: null };\n\nconst useStyles = makeStyles((theme) => ({\n  icon: {\n    color: theme.palette.text.secondary,\n    marginRight: theme.spacing(2),\n  },\n}));\n\nconst validationSchema = yup.object().shape({\n  adress: yup.string().required(),\n});\n\nexport default function Adress() {\n  const dispatch = useDispatch();\n  const router = useRouter();\n  const classes = useStyles();\n  const [value, setValue] = React.useState(null);\n  const [inputValue, setInputValue] = React.useState('');\n  const [options, setOptions] = React.useState([]);\n  const loaded = React.useRef(false);\n\n  // if (typeof window !== 'undefined' && !loaded.current) {\n  //   if (!document.querySelector('#google-maps')) {\n  //     loadScript(\n  //       'https://maps.googleapis.com/maps/api/js?key=AIzaSyATyME8aPrEABRhIh8mtOXnfNdQ8ofNEq0&libraries=places',\n  //       document.querySelector('head'),\n  //       'google-maps'\n  //     );\n  //   }\n\n  //   loaded.current = true;\n  // }\n\n  function removeGoogleMapScript() {\n    console.debug('removing google script...');\n    let keywords = ['maps.googleapis'];\n\n    //Remove google from BOM (window object)\n    window.google = undefined;\n\n    //Remove google map scripts from DOM\n    let scripts = document.head.getElementsByTagName('script');\n    for (let i = scripts.length - 1; i >= 0; i--) {\n      let scriptSource = scripts[i].getAttribute('src');\n      if (scriptSource != null) {\n        if (keywords.filter((item) => scriptSource.includes(item)).length) {\n          scripts[i].remove();\n          // scripts[i].parentNode.removeChild(scripts[i]);\n        }\n      }\n    }\n  }\n\n  const fetch = React.useMemo(\n    () =>\n      throttle((request, callback) => {\n        autocompleteService.current.getPlacePredictions(request, callback);\n      }, 200),\n    []\n  );\n\n  React.useEffect(() => {\n    let active = true;\n\n    if (!autocompleteService.current && window.google) {\n      autocompleteService.current = new window.google.maps.places.AutocompleteService();\n    }\n    if (!autocompleteService.current) {\n      return undefined;\n    }\n\n    if (inputValue === '') {\n      setOptions(value ? [value] : []);\n      return undefined;\n    }\n\n    fetch({ input: inputValue }, (results) => {\n      if (active) {\n        let newOptions = [];\n\n        if (value) {\n          newOptions = [value];\n        }\n\n        if (results) {\n          newOptions = [...newOptions, ...results];\n        }\n\n        setOptions(newOptions);\n      }\n    });\n\n    return () => {\n      active = false;\n    };\n  }, [value, inputValue, fetch]);\n  const state = useSelector((state) => state.reservation.location.adress);\n  return (\n    <Card>\n      <CardContent>\n        <Formik\n          initialValues={{\n            adress: '',\n          }}\n          validationSchema={validationSchema}\n          onSubmit={async (value) => {\n            const coords = async (value) => {\n              const results = await geocodeByAddress(value);\n              const latLng = await getLatLng(results[0]);\n              return latLng;\n            };\n            const latLng = await coords(value.adress.description);\n            const location = { adress: value.adress.description, latLng };\n            dispatch(reservationSlice.actions.setAdress(location));\n            removeGoogleMapScript();\n            router.push('/summary');\n          }}\n        >\n          {({ isSubmitting, values, setFieldValue, errors }) => (\n            <Form>\n              <Autocomplete\n                id=\"google-map-demo\"\n                style={{ width: 300 }}\n                getOptionLabel={(option) =>\n                  typeof option === 'string' ? option : option.description\n                }\n                filterOptions={(x) => x}\n                options={options}\n                autoComplete\n                includeInputInList\n                filterSelectedOptions\n                value={state}\n                onChange={(event, newValue) => {\n                  dispatch(\n                    reservationSlice.actions.setAdresDesc(newValue.description)\n                  );\n                  return setFieldValue('adress', newValue);\n                }}\n                onInputChange={(event, newInputValue) => {\n                  setInputValue(newInputValue);\n                }}\n                renderInput={(params) => (\n                  <TextField\n                    {...params}\n                    label=\"Add a location\"\n                    variant=\"outlined\"\n                  />\n                )}\n                renderOption={(option) => {\n                  const matches =\n                    option.structured_formatting.main_text_matched_substrings;\n                  const parts = parse(\n                    option.structured_formatting.main_text,\n                    matches.map((match) => [\n                      match.offset,\n                      match.offset + match.length,\n                    ])\n                  );\n\n                  return (\n                    <Grid container alignItems=\"center\">\n                      <Grid item>\n                        <LocationOnIcon className={classes.icon} />\n                      </Grid>\n                      <Grid item xs>\n                        {parts.map((part, index) => (\n                          <span\n                            key={index}\n                            style={{ fontWeight: part.highlight ? 700 : 400 }}\n                          >\n                            {part.text}\n                          </span>\n                        ))}\n\n                        <Typography variant=\"body2\" color=\"textSecondary\">\n                          {option.structured_formatting.secondary_text}\n                        </Typography>\n                      </Grid>\n                    </Grid>\n                  );\n                }}\n              />\n              <Button variant=\"contained\" color=\"primary\" type=\"submit\">\n                Submit\n              </Button>\n            </Form>\n          )}\n        </Formik>\n      </CardContent>\n    </Card>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}